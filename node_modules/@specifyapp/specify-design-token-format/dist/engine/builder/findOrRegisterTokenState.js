import { SDTFError } from '../../errors/index.js';
import { createTokenState } from './createTokenState.js';
export function findOrRegisterTokenState(stringPath, tokensState, analyzedTokens, treeState) {
    const maybeTokenState = tokensState.getOne(stringPath);
    if (maybeTokenState) {
        return maybeTokenState;
    }
    const maybeAnalyzedToken = analyzedTokens.getOne(stringPath);
    /* v8 ignore next 6 */
    if (!maybeAnalyzedToken) {
        throw new SDTFError('SDTF_INTERNAL_DESIGN_ERROR', `AnalyzedToken not found for token with path: ${stringPath}`);
    }
    const newTokenState = createTokenState(treeState, maybeAnalyzedToken);
    tokensState.add(newTokenState);
    return newTokenState;
}
