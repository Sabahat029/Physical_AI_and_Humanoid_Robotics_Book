import {
  ParsersEngineDataBox,
  ParsersEngineDataBoxType,
  SerializedParsersEngineDataBox,
} from '../definitions/parsersEngineDataBox.js';
import { createSDTFEngine } from '@specifyapp/specify-design-token-format';

/**
 * Deserialize a data box from a serialized data box
 * @param dataBox
 * @param previousType
 */
export function deserializeParsersEngineDataBox(
  dataBox: SerializedParsersEngineDataBox,
  previousType: ParsersEngineDataBoxType | undefined,
): ParsersEngineDataBox {
  if (dataBox.type === 'SDTF' && previousType === 'SDTF Engine') {
    return {
      type: 'SDTF Engine',
      engine: createSDTFEngine(dataBox.graph, dataBox.metadata),
    };
  }
  return dataBox;
}
