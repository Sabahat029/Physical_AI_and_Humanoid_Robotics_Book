import { z } from 'zod';
import { createBuiltInParserDefinition } from '../../internals/createBuiltInParserDefinition.js';
import { PrettierOptions } from '../../shared/prettier/formatWithPrettier.js';

export const prettierParserName = 'prettier';

export const prettierParserOptionsSchema = z
  .object({
    prettierOptions: z.custom<PrettierOptions>(v => v).optional(),
    matchOutputFilePath: z.string().optional(),
  })
  .strict();

export const prettierParserDefinition = createBuiltInParserDefinition({
  name: prettierParserName,
  kind: 'generation',
  hasOptionalOptions: true,
  optionsSchema: prettierParserOptionsSchema,
  hasOptionalOutput: true,
  outputTypes: undefined,
  inTypes: ['SDTF', 'SDTF Engine', 'vector', 'JSON', 'bitmap'],
  outType: 'SDTF Engine',
});

export type PrettierParserDefinition = typeof prettierParserDefinition;
