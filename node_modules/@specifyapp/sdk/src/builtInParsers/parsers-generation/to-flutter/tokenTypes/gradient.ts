import { SpecifyGradientValue } from '@specifyapp/specify-design-token-format';
import { renderColor } from './color.js';
import { numberToDouble } from '../utils.js';

export function renderGradient(gradient: SpecifyGradientValue) {
  const { colors, stops } = gradient.colorStops.reduce(
    (acc, curr) => {
      const color = renderColor(curr.color);
      if (!color) return acc;

      acc.colors.push(color);
      acc.stops.push(numberToDouble(curr.position));

      return acc;
    },
    { colors: [] as Array<string>, stops: [] as Array<string> },
  );

  if (colors.length === 0) return undefined;

  switch (gradient.type) {
    case 'conic': {
      return `RadialGradient(colors: <Color>[${colors.join(', ')}], stops: <double>[${stops.join(
        ', ',
      )}])`;
    }
    case 'radial': {
      return `RadialGradient(colors: <Color>[${colors.join(', ')}], stops: <double>[${stops.join(
        ', ',
      )}])`;
    }
    case 'linear': {
      return `LinearGradient(colors: <Color>[${colors.join(', ')}], stops: <double>[${stops.join(
        ', ',
      )}])`;
    }
  }
}
