import { z } from 'zod';
import type { Config } from 'svgo';

import { createBuiltInParserDefinition } from '../../internals/createBuiltInParserDefinition.js';

export const svgoParserName = 'svgo';

export const svgoParserOptionsSchema = z
  .object({
    svgo: z.custom<Config>(v => v).optional(),
  })
  .strict();

export const svgoParserDefinition = createBuiltInParserDefinition({
  name: svgoParserName,
  kind: 'generation',
  hasOptionalOptions: true,
  optionsSchema: svgoParserOptionsSchema,
  hasOptionalOutput: true,
  outputTypes: ['directory'],
  inTypes: ['SDTF', 'SDTF Engine', 'vector'],
  outType: 'vector',
});

export type SvgoParserDefinition = typeof svgoParserDefinition;
export type SvgoParserOptions = z.infer<SvgoParserDefinition['optionsSchema']>;
