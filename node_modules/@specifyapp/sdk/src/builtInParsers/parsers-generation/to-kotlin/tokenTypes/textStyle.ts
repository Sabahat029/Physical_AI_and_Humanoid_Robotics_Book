import { SpecifyTextStyleValue } from '@specifyapp/specify-design-token-format';
import { colorToKotlin } from './color.js';
import { textAlignmentHorizontalToKotlin } from './textAlignHorizontal.js';
import { fontToKotlin } from './font.js';
import { fontWeightToKotlin } from './fontWeight.js';

function pxToSp(px: number) {
  return `pxToSp(${px})`;
}

export function textStyleToKotlin(textStyle: SpecifyTextStyleValue) {
  let output = `TextStyle(fontFamily = FontFamily(${fontToKotlin(
    textStyle.font,
  )}), fontWeight = ${fontWeightToKotlin(textStyle.font.weight)}, fontStyle = ${
    textStyle.font.style === 'normal' ? 'FontStyle.Normal' : 'FontStyle.Italic'
  },`;

  if (textStyle.color) {
    output += ` color = ${colorToKotlin(textStyle.color)},`;
  }

  if (textStyle.fontSize && textStyle.fontSize.unit === 'px') {
    output += ` fontSize = ${pxToSp(textStyle.fontSize.value)},`;
  }

  if (textStyle.letterSpacing && textStyle.letterSpacing.unit === 'px') {
    output += ` letterSpacing = ${pxToSp(textStyle.letterSpacing.value)},`;
  }

  if (textStyle.lineHeight && textStyle.lineHeight.unit === 'px') {
    output += ` lineHeight = ${pxToSp(textStyle.lineHeight.value)},`;
  }

  if (textStyle.textIndent && textStyle.textIndent.unit === 'px') {
    output += ` textIndent = ${pxToSp(textStyle.textIndent.value)},`;
  }

  if (
    textStyle.textDecoration &&
    ['underline', 'line-through'].includes(textStyle.textDecoration)
  ) {
    output += ` textDecoration = ${
      textStyle.textDecoration === 'underline'
        ? 'TextDecoration.Underline'
        : 'TextDecoration.LineThrough'
    }),`;
  }

  if (textStyle.textAlignHorizontal) {
    output += ` textAlign = ${textAlignmentHorizontalToKotlin(textStyle.textAlignHorizontal)},`;
  }

  return output + ')';
}
