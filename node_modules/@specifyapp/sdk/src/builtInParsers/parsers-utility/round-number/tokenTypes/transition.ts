import { SpecifyTransitionValue } from '@specifyapp/specify-design-token-format';
import { NumberRounder } from '../makeNumberRounder.js';
import { getCubicBezierUpdateValue } from './cubicBezier.js';
import { KeysPerTokenTypeSelector } from '../definition.js';

export function getTransitionUpdateValue(
  transition: SpecifyTransitionValue,
  roundNumber: NumberRounder,
  applyToKeys: KeysPerTokenTypeSelector['transition'],
) {
  if (!applyToKeys || applyToKeys.includes('delay')) {
    transition.delay.value = roundNumber(transition.delay.value);
  }

  if (!applyToKeys || applyToKeys.includes('duration')) {
    transition.duration.value = roundNumber(transition.duration.value);
  }

  if (
    Array.isArray(transition.timingFunction) &&
    (!applyToKeys || applyToKeys.includes('timingFunction'))
  ) {
    transition.timingFunction = getCubicBezierUpdateValue(
      transition.timingFunction,
      roundNumber,
    ) as any;
  }

  return transition;
}
