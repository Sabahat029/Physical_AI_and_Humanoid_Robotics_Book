import { z } from 'zod';

import { specifyRepositorySchema } from '../definitions/repository.js';
import { createPublicHttpRouteDefinition } from '../internals/createPublicHttpRouteDefinition.js';

export function makeGetRepositoriesByOwnerRoute(options?: { owner: string }) {
  const { owner } = options ?? {};
  return `/v2/${owner ?? '{owner}'}/repositories`;
}

export const getRepositoriesByOwnerRouteSchema = z
  .object({
    owner: z.string(),
  })
  .strict();

export const getRepositoriesByOwnerRouteDefinition = createPublicHttpRouteDefinition({
  authenticationStrategy: 'personalAccessToken',
  httpMethod: 'GET',
  makeRoute: makeGetRepositoriesByOwnerRoute,
  responsePayloadSchema: z.array(specifyRepositorySchema),
  paramsSchema: getRepositoriesByOwnerRouteSchema,
});
